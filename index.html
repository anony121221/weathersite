<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cole's Weather Site</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 0;
            border-bottom: 1px solid #1e293b;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #3b82f6, #06b6d4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        button, input {
            background: #1e293b;
            border: 1px solid #334155;
            color: #e2e8f0;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        button:hover {
            background: #334155;
            border-color: #475569;
        }

        input {
            padding: 10px 15px;
            flex: 1;
            min-width: 200px;
        }

        input::placeholder {
            color: #64748b;
        }

        .file-list {
            list-style: none;
            margin: 20px 0;
        }

        .file-item {
            background: #1e293b;
            margin: 10px 0;
            padding: 15px 20px;
            border-radius: 8px;
            border: 1px solid #334155;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
        }

        .file-item:hover {
            background: #334155;
            border-color: #475569;
            transform: translateX(5px);
        }

        .file-item a {
            color: #3b82f6;
            text-decoration: none;
            font-weight: 500;
            flex-grow: 1;
        }

        .file-item a:hover {
            color: #06b6d4;
        }

        .file-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
        }

        .folder-icon {
            fill: #fbbf24;
        }

        .file-icon-doc {
            fill: #3b82f6;
        }

        .loading {
            text-align: center;
            color: #94a3b8;
            padding: 40px 20px;
        }

        .error {
            background: #7f1d1d;
            border: 1px solid #dc2626;
            color: #fca5a5;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .pagination button {
            padding: 8px 12px;
            min-width: auto;
        }

        .pagination button.active {
            background: #3b82f6;
            border-color: #06b6d4;
        }

        .stats {
            text-align: center;
            color: #94a3b8;
            margin: 10px 0;
            font-size: 0.9em;
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 1.8em;
            }

            .controls {
                flex-direction: column;
            }

            input {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üå§Ô∏è Cole's Weather Site</h1>
            <p style="color: #94a3b8;">Tornado NEXRAD Data Archive</p>
        </header>

        <div class="controls">
            <input type="text" id="searchInput" placeholder="Search files...">
            <button onclick="loadFiles()">üîÑ Refresh</button>
        </div>

        <div class="stats">
            <span>Total Files: <strong id="totalCount">0</strong> | Showing: <strong id="showingCount">0</strong></span>
        </div>

        <ul class="file-list" id="fileList">
            <li class="loading">Loading files...</li>
        </ul>

        <div class="pagination" id="pagination"></div>
    </div>

    <script>
        const FOLDER_ID = '1Xts9_L-N68visoeqmUgN1grSqQBpsL1M';
        const API_KEY = 'AIzaSyC431oUvXQR4tv7d8ZWfUZH3eQuR0rLLcM';
        const ITEMS_PER_PAGE = 20;

        let allFiles = [];
        let currentPage = 1;

        async function loadFiles() {
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '<li class="loading">Loading files...</li>';

            try {
                const url = `https://www.googleapis.com/drive/v3/files?q='${FOLDER_ID}'+in+parents&key=${API_KEY}&fields=files(id,name,mimeType,webViewLink)&orderBy=name&pageSize=1000`;
                
                const response = await fetch(url);
                if (!response.ok) throw new Error('Failed to fetch files');
                
                const data = await response.json();
                
                if (!data.files || data.files.length === 0) {
                    fileList.innerHTML = '<li class="file-item" style="justify-content: center;">No files found</li>';
                    document.getElementById('totalCount').textContent = '0';
                    document.getElementById('showingCount').textContent = '0';
                    return;
                }

                allFiles = data.files;
                currentPage = 1;
                filterAndDisplayFiles();
                setupSearch();

            } catch (error) {
                console.error('Error loading files:', error);
                fileList.innerHTML = '<li class="error">Error loading files. Make sure your API key is set correctly.</li>';
            }
        }

        function filterAndDisplayFiles() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const filtered = allFiles.filter(file => 
                file.name.toLowerCase().includes(searchTerm)
            );

            const startIdx = (currentPage - 1) * ITEMS_PER_PAGE;
            const endIdx = startIdx + ITEMS_PER_PAGE;
            const pageFiles = filtered.slice(startIdx, endIdx);

            const fileList = document.getElementById('fileList');
            
            if (pageFiles.length === 0) {
                fileList.innerHTML = '<li class="file-item" style="justify-content: center;">No files match your search</li>';
                document.getElementById('pagination').innerHTML = '';
                document.getElementById('showingCount').textContent = '0';
                return;
            }

            fileList.innerHTML = pageFiles.map(file => {
                const isFolder = file.mimeType === 'application/vnd.google-apps.folder';
                const icon = isFolder ? 
                    '<svg class="file-icon folder-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/></svg>' :
                    '<svg class="file-icon file-icon-doc" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>';
                
                return `
                    <li class="file-item">
                        ${icon}
                        <a href="${file.webViewLink}" target="_blank">${file.name}</a>
                    </li>
                `;
            }).join('');

            document.getElementById('totalCount').textContent = allFiles.length;
            document.getElementById('showingCount').textContent = pageFiles.length;
            setupPagination(filtered.length);
        }

        function setupPagination(totalItems) {
            const totalPages = Math.ceil(totalItems / ITEMS_PER_PAGE);
            const pagination = document.getElementById('pagination');
            
            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }

            let html = '';
            
            if (currentPage > 1) {
                html += `<button onclick="goToPage(${currentPage - 1})">‚Üê Previous</button>`;
            }

            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
                    html += `<button onclick="goToPage(${i})" class="${i === currentPage ? 'active' : ''}">${i}</button>`;
                } else if (i === currentPage - 2 || i === currentPage + 2) {
                    html += '<span style="padding: 8px 5px;">...</span>';
                }
            }

            if (currentPage < totalPages) {
                html += `<button onclick="goToPage(${currentPage + 1})">Next ‚Üí</button>`;
            }

            pagination.innerHTML = html;
        }

        function goToPage(page) {
            currentPage = page;
            filterAndDisplayFiles();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function setupSearch() {
            document.getElementById('searchInput').addEventListener('input', () => {
                currentPage = 1;
                filterAndDisplayFiles();
            });
        }

        loadFiles();
        setInterval(loadFiles, 60000);
    </script>
</body>
</html>
